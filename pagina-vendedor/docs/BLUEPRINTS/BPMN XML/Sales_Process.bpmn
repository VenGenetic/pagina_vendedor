<?xml version="1.0" encoding="UTF-8"?>
<bpmn:definitions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" xmlns:camunda="http://camunda.org/schema/1.0/bpmn" xmlns:bioc="http://bpmn.io/schema/bpmn/biocolor/1.0" id="Definitions_Sales" targetNamespace="http://menards.com/bpmn/sales" exporter="Camunda Modeler" exporterVersion="5.43.1">
  <bpmn:collaboration id="Collaboration_Sales">
    <bpmn:participant id="Participant_Sales" name="Sales Process (Hybrid + Drop Shipping)" processRef="Process_Sales" />
  </bpmn:collaboration>
  <bpmn:process id="Process_Sales" name="POS Sales Transaction with Drop Shipping" isExecutable="true">
    <bpmn:laneSet id="LaneSet_Sales">
      <bpmn:lane id="Lane_Communication" name="Communication (Chat Closers) / Comunicación">
        <bpmn:flowNodeRef>Activity_LeaderProcesses</bpmn:flowNodeRef>
      </bpmn:lane>
      <bpmn:lane id="Lane_Frontend" name="Frontend (POS) / Punto de Venta">
        <bpmn:flowNodeRef>StartEvent_SaleExternal</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>StartEvent_Return</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>StartEvent_Sale</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Activity_SelectReturnItems</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Activity_UploadDeliveryProof</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>EndEvent_Success</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>EndEvent_ReturnComplete</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Activity_SelectProducts</bpmn:flowNodeRef>
      </bpmn:lane>
      <bpmn:lane id="Lane_Backend" name="Backend (External Workers) / Backend">
        <bpmn:flowNodeRef>Activity_ReserveStock</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Gateway_StockValid</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Activity_ReleaseReservation</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>EndEvent_SaleFailed</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>SubProcess_SaleExecution</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>StartEvent_Return</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>BoundaryEvent_SaleFail</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Activity_ValidateReturn</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Activity_CreateRefund</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>SubProcess_DropShipping</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Activity_RestoreStock</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Activity_UpdateSaleStatus</bpmn:flowNodeRef>
      </bpmn:lane>
    </bpmn:laneSet>
    <bpmn:startEvent id="StartEvent_SaleExternal" name="Sale Reported (WhatsApp/Notion) / Venta Reportada">
      <bpmn:documentation>HYBRID ENTRY: Sales initiated by Chat Closers via WhatsApp or Notion. Leader acts as Gateway.</bpmn:documentation>
      <bpmn:outgoing>Flow_Ext1</bpmn:outgoing>
    </bpmn:startEvent>
    <bpmn:userTask id="Activity_LeaderProcesses" name="Leader Processes Sale in POS / Líder Procesa Venta">
      <bpmn:documentation>GATEWAY ROLE: Leader processes in POS to trigger inventory-reserve-stock in real-time.</bpmn:documentation>
      <bpmn:incoming>Flow_Ext1</bpmn:incoming>
      <bpmn:outgoing>Flow_Ext2</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:serviceTask id="Activity_ReserveStock" name="Validate &#38; Reserve Stock / Validar y Reservar Stock" camunda:asyncBefore="true" camunda:type="external" camunda:topic="inventory-reserve-stock">
      <bpmn:documentation>RESERVATION PATTERN: Moves items into RESERVED status.</bpmn:documentation>
      <bpmn:extensionElements>
        <camunda:failedJobRetryTimeCycle>R3/PT1M</camunda:failedJobRetryTimeCycle>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_2</bpmn:incoming>
      <bpmn:outgoing>Flow_3</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:exclusiveGateway id="Gateway_StockValid" name="Stock Reserved? / ¿Stock Reservado?">
      <bpmn:incoming>Flow_3</bpmn:incoming>
      <bpmn:outgoing>Flow_Yes</bpmn:outgoing>
      <bpmn:outgoing>Flow_No_DropShip</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:subProcess id="SubProcess_SaleExecution" name="Sale Execution (Local Stock) / Ejecución Venta">
      <bpmn:incoming>Flow_Yes</bpmn:incoming>
      <bpmn:outgoing>Flow_SubComplete</bpmn:outgoing>
      <bpmn:startEvent id="SubStart">
        <bpmn:outgoing>SubFlow_1</bpmn:outgoing>
      </bpmn:startEvent>
      <bpmn:serviceTask id="Activity_UpsertCustomer" name="Upsert Customer / Actualizar Cliente" camunda:type="external" camunda:topic="customer-upsert">
        <bpmn:incoming>SubFlow_1</bpmn:incoming>
        <bpmn:outgoing>SubFlow_2</bpmn:outgoing>
      </bpmn:serviceTask>
      <bpmn:serviceTask id="Activity_CreateSaleRecord" name="Insert Sale Header / Insertar Cabecera Venta" camunda:type="external" camunda:topic="sales-create-record">
        <bpmn:incoming>SubFlow_2</bpmn:incoming>
        <bpmn:outgoing>SubFlow_3</bpmn:outgoing>
      </bpmn:serviceTask>
      <bpmn:serviceTask id="Activity_CommitInventory" name="Commit (OUT) / Confirmar (SALIDA)" camunda:type="external" camunda:topic="inventory-commit-reservation">
        <bpmn:incoming>SubFlow_3</bpmn:incoming>
        <bpmn:outgoing>SubFlow_4</bpmn:outgoing>
      </bpmn:serviceTask>
      <bpmn:serviceTask id="Activity_CreateFinancials" name="Record Income / Registrar Ingreso" camunda:type="external" camunda:topic="finance-income-transaction">
        <bpmn:incoming>SubFlow_4</bpmn:incoming>
        <bpmn:outgoing>SubFlow_5</bpmn:outgoing>
      </bpmn:serviceTask>
      <bpmn:endEvent id="SubEnd">
        <bpmn:incoming>SubFlow_5</bpmn:incoming>
      </bpmn:endEvent>
      <bpmn:sequenceFlow id="SubFlow_1" sourceRef="SubStart" targetRef="Activity_UpsertCustomer" />
      <bpmn:sequenceFlow id="SubFlow_2" sourceRef="Activity_UpsertCustomer" targetRef="Activity_CreateSaleRecord" />
      <bpmn:sequenceFlow id="SubFlow_3" sourceRef="Activity_CreateSaleRecord" targetRef="Activity_CommitInventory" />
      <bpmn:sequenceFlow id="SubFlow_4" sourceRef="Activity_CommitInventory" targetRef="Activity_CreateFinancials" />
      <bpmn:sequenceFlow id="SubFlow_5" sourceRef="Activity_CreateFinancials" targetRef="SubEnd" />
    </bpmn:subProcess>
    <bpmn:boundaryEvent id="BoundaryEvent_SaleFail" name="Sale Failed / Venta Fallida" attachedToRef="SubProcess_SaleExecution">
      <bpmn:outgoing>Flow_Compensate</bpmn:outgoing>
      <bpmn:errorEventDefinition id="ErrorDef_SaleFail" />
    </bpmn:boundaryEvent>
    <bpmn:startEvent id="StartEvent_Return" name="Return Requested / Devolución Solicitada">
      <bpmn:outgoing>Flow_Ret1</bpmn:outgoing>
    </bpmn:startEvent>
    <bpmn:sequenceFlow id="Flow_Ext1" sourceRef="StartEvent_SaleExternal" targetRef="Activity_LeaderProcesses" />
    <bpmn:sequenceFlow id="Flow_Ext2" sourceRef="Activity_LeaderProcesses" targetRef="Activity_SelectProducts" />
    <bpmn:sequenceFlow id="Flow_1" sourceRef="StartEvent_Sale" targetRef="Activity_SelectProducts" />
    <bpmn:sequenceFlow id="Flow_2" sourceRef="Activity_SelectProducts" targetRef="Activity_ReserveStock" />
    <bpmn:sequenceFlow id="Flow_3" sourceRef="Activity_ReserveStock" targetRef="Gateway_StockValid" />
    <bpmn:sequenceFlow id="Flow_Yes" name="Yes" sourceRef="Gateway_StockValid" targetRef="SubProcess_SaleExecution">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${reservationSuccess == true}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_No_DropShip" name="No (DropShip)" sourceRef="Gateway_StockValid" targetRef="SubProcess_DropShipping">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${reservationSuccess == false}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_SubComplete" sourceRef="SubProcess_SaleExecution" targetRef="Activity_UploadDeliveryProof" />
    <bpmn:sequenceFlow id="Flow_DSComplete" sourceRef="SubProcess_DropShipping" targetRef="Activity_UploadDeliveryProof" />
    <bpmn:sequenceFlow id="Flow_ToSuccess" sourceRef="Activity_UploadDeliveryProof" targetRef="EndEvent_Success" />
    <bpmn:sequenceFlow id="Flow_Compensate" sourceRef="BoundaryEvent_SaleFail" targetRef="Activity_ReleaseReservation" />
    <bpmn:sequenceFlow id="Flow_ToFailed" sourceRef="Activity_ReleaseReservation" targetRef="EndEvent_SaleFailed" />
    <bpmn:sequenceFlow id="Flow_Ret1" sourceRef="StartEvent_Return" targetRef="Activity_SelectReturnItems" />
    <bpmn:sequenceFlow id="Flow_Ret2" sourceRef="Activity_SelectReturnItems" targetRef="Activity_ValidateReturn" />
    <bpmn:sequenceFlow id="Flow_Ret3" sourceRef="Activity_ValidateReturn" targetRef="Activity_CreateRefund" />
    <bpmn:sequenceFlow id="Flow_Ret4" sourceRef="Activity_CreateRefund" targetRef="Activity_RestoreStock" />
    <bpmn:sequenceFlow id="Flow_Ret5" sourceRef="Activity_RestoreStock" targetRef="Activity_UpdateSaleStatus" />
    <bpmn:sequenceFlow id="Flow_Ret6" sourceRef="Activity_UpdateSaleStatus" targetRef="EndEvent_ReturnComplete" />
    <bpmn:startEvent id="StartEvent_Sale" name="Sale Initiated (In-Person) / Venta Iniciada">
      <bpmn:outgoing>Flow_1</bpmn:outgoing>
    </bpmn:startEvent>
    <bpmn:userTask id="Activity_SelectReturnItems" name="Select Return Items / Seleccionar Ítems Devolución">
      <bpmn:incoming>Flow_Ret1</bpmn:incoming>
      <bpmn:outgoing>Flow_Ret2</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:userTask id="Activity_UploadDeliveryProof" name="Upload Shipping Ticket/Bill / Subir Comprobante Envío">
      <bpmn:documentation>Leader uploads photo of shipping receipt for audit.</bpmn:documentation>
      <bpmn:incoming>Flow_SubComplete</bpmn:incoming>
      <bpmn:incoming>Flow_DSComplete</bpmn:incoming>
      <bpmn:outgoing>Flow_ToSuccess</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:endEvent id="EndEvent_Success" name="Sale Completed / Venta Completada">
      <bpmn:incoming>Flow_ToSuccess</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:endEvent id="EndEvent_ReturnComplete" name="Return Complete / Devolución Completada">
      <bpmn:incoming>Flow_Ret6</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:serviceTask id="Activity_ReleaseReservation" name="Release Reservation / Liberar Reservación" camunda:type="external" camunda:topic="inventory-release-reservation">
      <bpmn:incoming>Flow_Compensate</bpmn:incoming>
      <bpmn:outgoing>Flow_ToFailed</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:endEvent id="EndEvent_SaleFailed" name="Sale Failed / Venta Fallida">
      <bpmn:incoming>Flow_ToFailed</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:serviceTask id="Activity_ValidateReturn" name="Validate Return / Validar Devolución" camunda:type="external" camunda:topic="sales-validate-return">
      <bpmn:incoming>Flow_Ret2</bpmn:incoming>
      <bpmn:outgoing>Flow_Ret3</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:serviceTask id="Activity_CreateRefund" name="Create Reversal / Crear Reversión" camunda:type="external" camunda:topic="finance-create-refund">
      <bpmn:incoming>Flow_Ret3</bpmn:incoming>
      <bpmn:outgoing>Flow_Ret4</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:userTask id="Activity_SelectProducts" name="Select Products and Customer / Seleccionar Productos y Cliente">
      <bpmn:incoming>Flow_1</bpmn:incoming>
      <bpmn:incoming>Flow_Ext2</bpmn:incoming>
      <bpmn:outgoing>Flow_2</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:subProcess id="SubProcess_DropShipping" name="Drop Shipping Fulfillment / Cumplimiento Drop Shipping">
      <bpmn:documentation>FAILOVER: When local stock insufficient, route to drop shipping with demand logging.</bpmn:documentation>
      <bpmn:incoming>Flow_No_DropShip</bpmn:incoming>
      <bpmn:outgoing>Flow_DSComplete</bpmn:outgoing>
      <bpmn:startEvent id="DSStart">
        <bpmn:outgoing>DSFlow_1</bpmn:outgoing>
      </bpmn:startEvent>
      <bpmn:serviceTask id="Activity_CheckProviderStock" name="Check Provider / Verificar Proveedor" camunda:type="external" camunda:topic="provider-availability-check">
        <bpmn:documentation>AVAILABILITY SCRAPPING: Checks provider stock, detects scrapped products.</bpmn:documentation>
        <bpmn:incoming>DSFlow_1</bpmn:incoming>
        <bpmn:outgoing>DSFlow_2</bpmn:outgoing>
      </bpmn:serviceTask>
      <bpmn:exclusiveGateway id="Gateway_ProviderHasStock" name="Provider OK? / ¿Proveedor OK?">
        <bpmn:incoming>DSFlow_2</bpmn:incoming>
        <bpmn:outgoing>DSFlow_Yes</bpmn:outgoing>
        <bpmn:outgoing>DSFlow_Scrapped</bpmn:outgoing>
      </bpmn:exclusiveGateway>
      <bpmn:serviceTask id="Activity_CreateDropShipOrder" name="Create DS Order / Crear Orden DS" camunda:type="external" camunda:topic="dropship-create-order">
        <bpmn:incoming>DSFlow_Yes</bpmn:incoming>
        <bpmn:outgoing>DSFlow_3</bpmn:outgoing>
      </bpmn:serviceTask>
      <bpmn:serviceTask id="Activity_CreateDualFinancials" name="Income + Cost / Ingreso + Costo" camunda:type="external" camunda:topic="finance-atomic-dual-entry">
        <bpmn:documentation>ATOMIC LINKAGE: Records Income AND Provider Expense in same group.</bpmn:documentation>
        <bpmn:incoming>DSFlow_3</bpmn:incoming>
        <bpmn:outgoing>DSFlow_4</bpmn:outgoing>
      </bpmn:serviceTask>
      <bpmn:serviceTask id="Activity_LogDemandHit" name="Log Demand / Registrar Demanda" camunda:type="external" camunda:topic="demand-aggregator-log">
        <bpmn:documentation>DEMAND AGGREGATION: Records demand for Restock suggestions.</bpmn:documentation>
        <bpmn:incoming>DSFlow_4</bpmn:incoming>
        <bpmn:outgoing>DSFlow_5</bpmn:outgoing>
      </bpmn:serviceTask>
      <bpmn:endEvent id="DSEnd_Success">
        <bpmn:incoming>DSFlow_5</bpmn:incoming>
      </bpmn:endEvent>
      <bpmn:serviceTask id="Activity_TriggerSagaReversal" name="Trigger Reversal / Disparar Reversión" camunda:type="external" camunda:topic="sales-trigger-saga-reversal">
        <bpmn:documentation>SAGA: Product scrapped - refund customer via Financial saga.</bpmn:documentation>
        <bpmn:incoming>DSFlow_Scrapped</bpmn:incoming>
        <bpmn:outgoing>DSFlow_Reversed</bpmn:outgoing>
      </bpmn:serviceTask>
      <bpmn:endEvent id="DSEnd_Cancelled" name="DS Cancelled / DS Cancelado">
        <bpmn:incoming>DSFlow_Reversed</bpmn:incoming>
      </bpmn:endEvent>
      <bpmn:sequenceFlow id="DSFlow_1" sourceRef="DSStart" targetRef="Activity_CheckProviderStock" />
      <bpmn:sequenceFlow id="DSFlow_2" sourceRef="Activity_CheckProviderStock" targetRef="Gateway_ProviderHasStock" />
      <bpmn:sequenceFlow id="DSFlow_Yes" name="Yes" sourceRef="Gateway_ProviderHasStock" targetRef="Activity_CreateDropShipOrder">
        <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${providerHasStock == true}</bpmn:conditionExpression>
      </bpmn:sequenceFlow>
      <bpmn:sequenceFlow id="DSFlow_Scrapped" name="Scrapped" sourceRef="Gateway_ProviderHasStock" targetRef="Activity_TriggerSagaReversal">
        <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${providerHasStock == false}</bpmn:conditionExpression>
      </bpmn:sequenceFlow>
      <bpmn:sequenceFlow id="DSFlow_3" sourceRef="Activity_CreateDropShipOrder" targetRef="Activity_CreateDualFinancials" />
      <bpmn:sequenceFlow id="DSFlow_4" sourceRef="Activity_CreateDualFinancials" targetRef="Activity_LogDemandHit" />
      <bpmn:sequenceFlow id="DSFlow_5" sourceRef="Activity_LogDemandHit" targetRef="DSEnd_Success" />
      <bpmn:sequenceFlow id="DSFlow_Reversed" sourceRef="Activity_TriggerSagaReversal" targetRef="DSEnd_Cancelled" />
    </bpmn:subProcess>
    <bpmn:serviceTask id="Activity_RestoreStock" name="Restore Stock / Restaurar Stock" camunda:type="external" camunda:topic="inventory-restore-stock">
      <bpmn:incoming>Flow_Ret4</bpmn:incoming>
      <bpmn:outgoing>Flow_Ret5</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:serviceTask id="Activity_UpdateSaleStatus" name="Status: RETURNED / Estado: DEVUELTO" camunda:type="external" camunda:topic="sales-update-status-returned">
      <bpmn:incoming>Flow_Ret5</bpmn:incoming>
      <bpmn:outgoing>Flow_Ret6</bpmn:outgoing>
    </bpmn:serviceTask>
  </bpmn:process>
  <bpmn:error id="Error_StockInsufficient" name="Stock Insufficient" errorCode="ERR_STOCK_001" />
  <bpmn:error id="Error_ProviderScrapped" name="Provider Scrapped" errorCode="ERR_PROVIDER_001" />
  <bpmndi:BPMNDiagram id="BPMNDiagram_Sales">
    <bpmndi:BPMNPlane id="BPMNPlane_Sales" bpmnElement="Collaboration_Sales">
      <bpmndi:BPMNShape id="Participant_Sales_di" bpmnElement="Participant_Sales" isHorizontal="true">
        <dc:Bounds x="160" y="80" width="2000" height="1000" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Lane_Backend_di" bpmnElement="Lane_Backend" isHorizontal="true">
        <dc:Bounds x="190" y="340" width="1970" height="740" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Lane_Frontend_di" bpmnElement="Lane_Frontend" isHorizontal="true">
        <dc:Bounds x="190" y="180" width="1970" height="160" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Lane_Communication_di" bpmnElement="Lane_Communication" isHorizontal="true">
        <dc:Bounds x="190" y="80" width="1970" height="100" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="StartEvent_SaleExternal_di" bpmnElement="StartEvent_SaleExternal" bioc:stroke="#43A047" bioc:fill="#C8E6C9">
        <dc:Bounds x="232" y="112" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="206" y="155" width="89" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_LeaderProcesses_di" bpmnElement="Activity_LeaderProcesses" bioc:stroke="#1E88E5" bioc:fill="#BBDEFB">
        <dc:Bounds x="320" y="90" width="120" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_ReserveStock_di" bpmnElement="Activity_ReserveStock" bioc:stroke="#FB8C00" bioc:fill="#FFE0B2">
        <dc:Bounds x="620" y="380" width="120" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_StockValid_di" bpmnElement="Gateway_StockValid" isMarkerVisible="true" bioc:stroke="#FDD835" bioc:fill="#FFF9C4">
        <dc:Bounds x="780" y="395" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="748" y="365" width="84" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_ReleaseReservation_di" bpmnElement="Activity_ReleaseReservation" bioc:stroke="#E53935" bioc:fill="#FFCDD2">
        <dc:Bounds x="1860" y="600" width="120" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="EndEvent_SaleFailed_di" bpmnElement="EndEvent_SaleFailed" bioc:stroke="#E53935" bioc:fill="#FFCDD2">
        <dc:Bounds x="1662" y="772" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1649" y="815" width="63" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_ValidateReturn_di" bpmnElement="Activity_ValidateReturn">
        <dc:Bounds x="300" y="940" width="120" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_CreateRefund_di" bpmnElement="Activity_CreateRefund">
        <dc:Bounds x="470" y="940" width="120" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_SelectProducts_di" bpmnElement="Activity_SelectProducts" bioc:stroke="#1E88E5" bioc:fill="#BBDEFB">
        <dc:Bounds x="610" y="190" width="120" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_RestoreStock_di" bpmnElement="Activity_RestoreStock">
        <dc:Bounds x="700" y="940" width="120" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_UpdateSaleStatus_di" bpmnElement="Activity_UpdateSaleStatus">
        <dc:Bounds x="960" y="950" width="120" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="SubProcess_SaleExecution_di" bpmnElement="SubProcess_SaleExecution" isExpanded="true" bioc:stroke="#8E24AA" bioc:fill="#F3E5F5">
        <dc:Bounds x="880" y="360" width="850" height="150" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="SubStart_di" bpmnElement="SubStart">
        <dc:Bounds x="900" y="417" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_UpsertCustomer_di" bpmnElement="Activity_UpsertCustomer">
        <dc:Bounds x="950" y="395" width="120" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_CreateSaleRecord_di" bpmnElement="Activity_CreateSaleRecord">
        <dc:Bounds x="1120" y="395" width="120" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_CommitInventory_di" bpmnElement="Activity_CommitInventory">
        <dc:Bounds x="1290" y="395" width="120" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_CreateFinancials_di" bpmnElement="Activity_CreateFinancials">
        <dc:Bounds x="1460" y="395" width="120" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="SubEnd_di" bpmnElement="SubEnd">
        <dc:Bounds x="1650" y="417" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="SubFlow_1_di" bpmnElement="SubFlow_1">
        <di:waypoint x="936" y="435" />
        <di:waypoint x="950" y="435" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SubFlow_2_di" bpmnElement="SubFlow_2">
        <di:waypoint x="1070" y="435" />
        <di:waypoint x="1120" y="435" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SubFlow_3_di" bpmnElement="SubFlow_3">
        <di:waypoint x="1240" y="435" />
        <di:waypoint x="1290" y="435" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SubFlow_4_di" bpmnElement="SubFlow_4">
        <di:waypoint x="1410" y="435" />
        <di:waypoint x="1460" y="435" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SubFlow_5_di" bpmnElement="SubFlow_5">
        <di:waypoint x="1580" y="435" />
        <di:waypoint x="1650" y="435" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="StartEvent_Return_di" bpmnElement="StartEvent_Return" bioc:stroke="#43A047" bioc:fill="#C8E6C9">
        <dc:Bounds x="232" y="292" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="206" y="335" width="89" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="StartEvent_Sale_di" bpmnElement="StartEvent_Sale" bioc:stroke="#43A047" bioc:fill="#C8E6C9">
        <dc:Bounds x="232" y="212" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="209" y="255" width="84" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_SelectReturnItems_di" bpmnElement="Activity_SelectReturnItems" bioc:stroke="#1E88E5" bioc:fill="#BBDEFB">
        <dc:Bounds x="350" y="245" width="120" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_UploadDeliveryProof_di" bpmnElement="Activity_UploadDeliveryProof" bioc:stroke="#1E88E5" bioc:fill="#BBDEFB">
        <dc:Bounds x="1800" y="230" width="120" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="EndEvent_Success_di" bpmnElement="EndEvent_Success" bioc:stroke="#43A047" bioc:fill="#C8E6C9">
        <dc:Bounds x="1950" y="252" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1928" y="228" width="79" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="EndEvent_ReturnComplete_di" bpmnElement="EndEvent_ReturnComplete" bioc:stroke="#43A047" bioc:fill="#C8E6C9">
        <dc:Bounds x="1600" y="252" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1577" y="295" width="84" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="SubProcess_DropShipping_di" bpmnElement="SubProcess_DropShipping" isExpanded="true" bioc:stroke="#00897B" bioc:fill="#E0F2F1">
        <dc:Bounds x="440" y="550" width="1100" height="300" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="DSStart_di" bpmnElement="DSStart">
        <dc:Bounds x="460" y="622" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_CheckProviderStock_di" bpmnElement="Activity_CheckProviderStock">
        <dc:Bounds x="520" y="600" width="120" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_ProviderHasStock_di" bpmnElement="Gateway_ProviderHasStock" isMarkerVisible="true">
        <dc:Bounds x="690" y="615" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="675" y="670" width="83" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_CreateDropShipOrder_di" bpmnElement="Activity_CreateDropShipOrder">
        <dc:Bounds x="810" y="570" width="120" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_CreateDualFinancials_di" bpmnElement="Activity_CreateDualFinancials">
        <dc:Bounds x="970" y="570" width="120" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_LogDemandHit_di" bpmnElement="Activity_LogDemandHit">
        <dc:Bounds x="1130" y="570" width="120" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="DSEnd_Success_di" bpmnElement="DSEnd_Success">
        <dc:Bounds x="1340" y="592" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_TriggerSagaReversal_di" bpmnElement="Activity_TriggerSagaReversal">
        <dc:Bounds x="810" y="730" width="120" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="DSEnd_Cancelled_di" bpmnElement="DSEnd_Cancelled">
        <dc:Bounds x="990" y="752" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="973" y="795" width="75" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="DSFlow_1_di" bpmnElement="DSFlow_1">
        <di:waypoint x="496" y="640" />
        <di:waypoint x="520" y="640" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="DSFlow_2_di" bpmnElement="DSFlow_2">
        <di:waypoint x="640" y="640" />
        <di:waypoint x="690" y="640" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="DSFlow_Yes_di" bpmnElement="DSFlow_Yes">
        <di:waypoint x="715" y="615" />
        <di:waypoint x="715" y="610" />
        <di:waypoint x="810" y="610" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="721" y="591" width="18" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="DSFlow_Scrapped_di" bpmnElement="DSFlow_Scrapped">
        <di:waypoint x="715" y="665" />
        <di:waypoint x="715" y="770" />
        <di:waypoint x="810" y="770" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="717" y="745" width="48" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="DSFlow_3_di" bpmnElement="DSFlow_3">
        <di:waypoint x="930" y="610" />
        <di:waypoint x="970" y="610" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="DSFlow_4_di" bpmnElement="DSFlow_4">
        <di:waypoint x="1090" y="610" />
        <di:waypoint x="1130" y="610" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="DSFlow_5_di" bpmnElement="DSFlow_5">
        <di:waypoint x="1250" y="610" />
        <di:waypoint x="1340" y="610" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="DSFlow_Reversed_di" bpmnElement="DSFlow_Reversed">
        <di:waypoint x="930" y="770" />
        <di:waypoint x="990" y="770" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="BoundaryEvent_SaleFail_di" bpmnElement="BoundaryEvent_SaleFail">
        <dc:Bounds x="1712" y="492" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1757.5" y="496" width="63" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="Flow_Ext1_di" bpmnElement="Flow_Ext1">
        <di:waypoint x="268" y="130" />
        <di:waypoint x="320" y="130" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_Ext2_di" bpmnElement="Flow_Ext2">
        <di:waypoint x="440" y="130" />
        <di:waypoint x="640" y="130" />
        <di:waypoint x="640" y="190" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1_di" bpmnElement="Flow_1">
        <di:waypoint x="268" y="230" />
        <di:waypoint x="610" y="230" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_2_di" bpmnElement="Flow_2">
        <di:waypoint x="670" y="270" />
        <di:waypoint x="670" y="335" />
        <di:waypoint x="680" y="335" />
        <di:waypoint x="680" y="380" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_3_di" bpmnElement="Flow_3">
        <di:waypoint x="740" y="420" />
        <di:waypoint x="780" y="420" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_Yes_di" bpmnElement="Flow_Yes">
        <di:waypoint x="830" y="420" />
        <di:waypoint x="880" y="420" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="841" y="402" width="18" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_No_DropShip_di" bpmnElement="Flow_No_DropShip">
        <di:waypoint x="805" y="445" />
        <di:waypoint x="805" y="550" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="814" y="531" width="71" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_SubComplete_di" bpmnElement="Flow_SubComplete">
        <di:waypoint x="1730" y="435" />
        <di:waypoint x="1765" y="435" />
        <di:waypoint x="1765" y="270" />
        <di:waypoint x="1800" y="270" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_DSComplete_di" bpmnElement="Flow_DSComplete">
        <di:waypoint x="1540" y="700" />
        <di:waypoint x="1765" y="700" />
        <di:waypoint x="1765" y="270" />
        <di:waypoint x="1800" y="270" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_ToSuccess_di" bpmnElement="Flow_ToSuccess">
        <di:waypoint x="1920" y="270" />
        <di:waypoint x="1950" y="270" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_Compensate_di" bpmnElement="Flow_Compensate">
        <di:waypoint x="1730" y="528" />
        <di:waypoint x="1730" y="640" />
        <di:waypoint x="1860" y="640" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_ToFailed_di" bpmnElement="Flow_ToFailed">
        <di:waypoint x="1860" y="640" />
        <di:waypoint x="1748" y="640" />
        <di:waypoint x="1748" y="790" />
        <di:waypoint x="1698" y="790" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_Ret1_di" bpmnElement="Flow_Ret1">
        <di:waypoint x="268" y="310" />
        <di:waypoint x="350" y="310" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_Ret2_di" bpmnElement="Flow_Ret2">
        <di:waypoint x="410" y="325" />
        <di:waypoint x="410" y="578" />
        <di:waypoint x="360" y="578" />
        <di:waypoint x="360" y="940" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_Ret3_di" bpmnElement="Flow_Ret3">
        <di:waypoint x="420" y="980" />
        <di:waypoint x="470" y="980" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_Ret4_di" bpmnElement="Flow_Ret4">
        <di:waypoint x="590" y="980" />
        <di:waypoint x="700" y="980" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_Ret5_di" bpmnElement="Flow_Ret5">
        <di:waypoint x="820" y="990" />
        <di:waypoint x="960" y="990" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_Ret6_di" bpmnElement="Flow_Ret6">
        <di:waypoint x="1080" y="990" />
        <di:waypoint x="1580" y="990" />
        <di:waypoint x="1580" y="270" />
        <di:waypoint x="1600" y="270" />
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn:definitions>